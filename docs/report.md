# AI-Powered Personalized Meal Planner

**Prepared for:** UMBC Data Science Master Degree Capstone by Dr. Chaojie (Jay) Wang  
**Author:** Madhu Priya P  
**GitHub Repo:** https://github.com/MaDHuPRi/UMBC-DATA606-Capstone  
**LinkedIn Profile:** https://www.linkedin.com/in/madhu-priya-pulletikurthi-917114271/   
**PowerPoint Presentation:** _to be added_  
**YouTube Video:** _to be added_  

---

## 2. Background

**What is it about?**  
The AI-Powered Meal Planner is a personalized system that helps users generate daily meal plans based on their **calorie requirements and nutritional preferences**. It leverages **unsupervised learning (clustering)** to categorize foods into meaningful nutritional groups and uses a **Hugging Face LLM** to generate **meal plans and recipes** in a user-friendly format. The output includes **recipes, grocery lists, and a macros donut chart** to show nutritional balance.  

**Why does it matter?**  
- Many existing meal planning tools provide static or minimally personalized recommendations.  
- This system combines **clustering + LLM-based generation**, allowing **dynamic, actionable, and fully personalized meal plans**.  
- Supports users in meeting health goals while saving time and simplifying meal planning.  
- The **LLM-generated output** delivers complete daily meal plans and recipes, making it immediately usable.  

**Research Questions:**  
1. How can clustering algorithms categorize foods into meaningful nutritional groups?  
2. How can LLMs generate daily meal plans aligned with user-specific calorie and nutrition requirements?  
3. How can the system present meal plans in a clear, actionable, and understandable format?  

---

## 3. Data

**Data Sources:**  
- USDA Foods dataset (~50,000 rows), collected via API queries  

**Data Size:**  
- ~50 MB  

**Data Shape:**  
- Rows: 50,000  
- Columns: 9  

**Time Period:**  
- Static dataset; not time-bound  

**Row Representation:**  
- Each row represents one food item with its nutritional information  

**Data Dictionary:**  

| Column | Type | Non-null Count | Notes |
|---------|------|----------------|-------|
| `fdcId` | int64 | 20,000 | Unique ID for each food item |
| `description` | object | 20,000 | Text name/description of the food |
| `dataType` | object | 20,000 | Category or source label (e.g., “SR Legacy”) |
| `calories` | float64 | 19,597 | Small number of missing values (~2%) |
| `protein_g` | float64 | 19,834 | Few missing values (~0.8%) |
| `carbs_g` | float64 | 19,702 | Some missing values (~1.5%) |
| `fat_g` | float64 | 19,818 | Few missing values (~0.9%) |
| `fiber_g` | float64 | 17,448 | Moderate missing values (~13%) |
| `sugar_g` | float64 | 0 | Entire column missing — no usable data |

**Target / Label:**  
- Unsupervised learning → cluster labels assigned to each food item (e.g., High Protein, Low Fat, Low Carb, etc.)  

**Features / Predictors:**  
- calories, protein_g, carbs_g, fat_g, fiber_g, along with some engineered features like calorie to protein ratio etc.  
- **Note:** Few features were collected via API queries.  

**Output:**  
- The final **output** of the system is the **daily meal plan and recipes generated by the Hugging Face LLM**, along with a **grocery list** and **macros visualization**.  

---
## 4. Exploratory Data Analysis (EDA)

### 4.1 Data Overview
The dataset contains meal-level nutritional attributes such as calories, protein, carbohydrates, fats, vitamins, and minerals.  
Initial inspection (`df.info()`, `df.describe()`) showed consistent data types and minimal missing values.  
Some variables (e.g., calories, carbohydrates) exhibited strong right skew, which indicated the need for transformation.  
Each record represents a single meal, and each column corresponds to a unique nutritional property, confirming that the data are tidy.

---

### 4.2 Distribution Analysis
To understand feature behavior, **Plotly Express** histograms and box plots were created for key nutritional variables.  

**Insights**
- Calorie and carbohydrate distributions are highly right-skewed.  
- Protein and fat vary moderately across meals.  
- Several extreme values (outliers) exist but were retained for interpretability.  

```python
import plotly.express as px
fig = px.histogram(df, x="Calories", nbins=30, title="Distribution of Calories")
fig.show()
```
### 4.3 Correlation Analysis
A correlation heatmap identified relationships among nutrients.
Calories, carbohydrates, and fat were strongly correlated, while micronutrients had weaker links.
These observations helped select the most informative variables for clustering.

```python
corr = df.corr(numeric_only=True)
fig = px.imshow(corr, text_auto=True, title="Correlation Heatmap")
fig.show()
```

## 5 Modelling and Dataset Preparation (ML-Based)

### 5.1 Objective
To discover natural groupings among meals and enrich the dataset with interpretable cluster labels representing nutritional profiles.

### 5.2 Preprocessing and Clustering
Numeric features were standardized using StandardScaler and clustered with K-Means (k = 4).
This approach groups meals into four nutritional categories based on macronutrient composition.

```python
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans

scaler = StandardScaler()
X_scaled = scaler.fit_transform(df.select_dtypes("number"))
kmeans = KMeans(n_clusters=4, random_state=42)
df["Cluster"] = kmeans.fit_predict(X_scaled)
```
### 5.3 Cluster Statistics
Cluster means revealed distinctive profiles (e.g., high-protein, balanced, carb-heavy).
These summary statistics will later guide the LLM in contextual reasoning.

```python
cluster_means = df.groupby("Cluster").mean().reset_index()
cluster_means
```





