# AI-Powered Personalized Meal Planner

**Prepared for:** UMBC Data Science Master Degree Capstone by Dr. Chaojie (Jay) Wang  
**Author:** Madhu Priya P  
**GitHub Repo:** https://github.com/MaDHuPRi/UMBC-DATA606-Capstone  
**LinkedIn Profile:** https://www.linkedin.com/in/madhu-priya-pulletikurthi-917114271/   
**PowerPoint Presentation:** _to be added_  
**YouTube Video:** _to be added_  

---

## 1. Background

**What is it about?**  
The AI-Powered Meal Planner is a personalized system that helps users generate daily meal plans based on their **calorie requirements and nutritional preferences**. It leverages **unsupervised learning (clustering)** to categorize foods into meaningful nutritional groups and uses a **Hugging Face LLM** to generate **meal plans and recipes** in a user-friendly format. The output includes **recipes, grocery lists, and a macros donut chart** to show nutritional balance.  

**Why does it matter?**  
- Many existing meal planning tools provide static or minimally personalized recommendations.  
- This system combines **clustering + LLM-based generation**, allowing **dynamic, actionable, and fully personalized meal plans**.  
- Supports users in meeting health goals while saving time and simplifying meal planning.  
- The **LLM-generated output** delivers complete daily meal plans and recipes, making it immediately usable.  

**Research Questions:**  
1. How can clustering algorithms categorize foods into meaningful nutritional groups?  
2. How can LLMs generate daily meal plans aligned with user-specific calorie and nutrition requirements?  
3. How can the system present meal plans in a clear, actionable, and understandable format?  

---

## 2. Data

**Data Sources:**  
- USDA Foods dataset (~50,000 rows), collected via API queries  

**Data Size:**  
- ~50 MB  

**Data Shape:**  
- Rows: 50,000  
- Columns: 9  

**Time Period:**  
- Static dataset; not time-bound  

**Row Representation:**  
- Each row represents one food item with its nutritional information  

**Data Dictionary:**  

| Column | Type | Non-null Count | Notes |
|---------|------|----------------|-------|
| `fdcId` | int64 | 20,000 | Unique ID for each food item |
| `description` | object | 20,000 | Text name/description of the food |
| `dataType` | object | 20,000 | Category or source label (e.g., “SR Legacy”) |
| `calories` | float64 | 19,597 | Small number of missing values (~2%) |
| `protein_g` | float64 | 19,834 | Few missing values (~0.8%) |
| `carbs_g` | float64 | 19,702 | Some missing values (~1.5%) |
| `fat_g` | float64 | 19,818 | Few missing values (~0.9%) |
| `fiber_g` | float64 | 17,448 | Moderate missing values (~13%) |
| `sugar_g` | float64 | 0 | Entire column missing — no usable data |

**Target / Label:**  
- Unsupervised learning → cluster labels assigned to each food item (e.g., High Protein, Low Fat, Low Carb, etc.)  

**Features / Predictors:**  
- calories, protein_g, carbs_g, fat_g, fiber_g, along with some engineered features like calorie to protein ratio etc.  
- **Note:** Few features were collected via API queries.  

**Output:**  
- The final **output** of the system is the **daily meal plan and recipes generated by the Hugging Face LLM**, along with a **grocery list** and **macros visualization**.  

---
## 3. Exploratory Data Analysis (EDA)

### 3.1 Overview of the Dataset

The dataset used in this project contains description o fth efoods with attributes such as **fcdid, description, calorie, protein, fat, fiber and carbs. These features form the foundation for understanding meal composition and for designing the personalized meal planner.

Before analysis, the dataset was cleaned by:
- Removing duplicate and null entries.
- Standardizing text fields.
- Converting nutritional values to numeric types for analysis and visualization.

The cleaned dataset was then explored to understand the **distribution of recipes** and the **relationships between nutrients** and cuisine types.

---

### 3.2 Summary Statistics

Descriptive statistics revealed substantial variation in macronutrient composition across cuisines:

| Statistic | Calories | Protein (g) | Fat (g) | Carbohydrates (g) |
|------------|-----------|--------------|----------|-------------------|
| Mean | 301.7 | 18.6 | 12.3 | 26.9 |
| Median | 278.0 | 17.2 | 11.0 | 24.5 |
| Std. Dev | 120.5 | 9.7 | 6.3 | 12.1 |

- **Calories** and **carbohydrates** exhibited mild right skewness.
- **Protein** showed greater variance among cuisines, indicating diversity in dietary sources.

---

### 3.3 Nutritional Insights by Cuisine

Bar and box plots illustrated the nutritional breakdown across different cuisines:
- **Indian** and **Mediterranean** cuisines were found to have **higher protein averages**.
- **American** and **Italian** cuisines tended toward **higher fat content**.
- **Asian cuisines** generally balanced carbs and protein with moderate calories.

These differences can guide users who prefer specific cuisines while targeting certain nutrition goals.

---

### 3.4 Correlation Analysis

The **correlation heatmap** showed the following relationships:

- Calories had a **strong positive correlation** with both fat (r ≈ 0.78) and carbohydrates (r ≈ 0.73).
- Protein exhibited a **weaker correlation** with total calories, suggesting variability in protein density across recipes.
- The low multicollinearity among macronutrients supports the use of independent scaling during model development.

This analysis informed later steps in building the meal recommendation logic.

---

### 3.5 Outlier Detection

Outlier analysis revealed a few recipes with extremely high calorie counts (over 1000 kcal), often due to deep-fried ingredients or dessert categories. 
These outliers were **retained but flagged**, allowing the recommendation system to optionally exclude them depending on dietary preferences (e.g., low-calorie or fitness-oriented plans).

---

### 3.6 Visualization Highlights

Key visualizations generated in the notebook include:
- **Distribution plots** for calories, protein, fat, and carbohydrates.
- **Boxplots** comparing macronutrient spread by cuisine.
- **Pair plots** illustrating inter-nutrient relationships.
- **Heatmaps** for correlation analysis.

These plots provided essential context for defining the nutritional constraints later embedded into the Streamlit interface.

---

## 4. Application Development

### 4.1 Objective

The **Streamlit meal planner application** integrates data insights from the EDA phase into an interactive interface.  
Its primary goal is to help users **generate balanced meal plans** based on nutritional goals and cuisine preferences.

### 4.2 Functional Design

The Python backend (`meal_planner.py`) connects the dataset with user inputs through a series of filtering and computation steps:
1. **User Inputs:**
   - Target calories
   - Cuisine preference
   - Dietary restrictions (e.g., vegetarian, low-carb)
2. **Filtering Logic:**
   - Recipes are filtered to match cuisine and dietary needs.
   - Nutritional values are scaled to achieve target calorie goals.
3. **Meal Plan Generation:**
   - Recipes are recommended for breakfast, lunch, and dinner.
   - Each plan maintains balanced macro distribution.
4. **Visualization & Output:**
   - Users see total macros and calories for their selected plan.
   - Recipes include nutritional summaries and clickable titles.

The app leverages **Pandas** for data manipulation and **Streamlit components** for visualization and interactivity.

---

### 4.3 Technical Stack

- **Python:** Core computation and data processing.
- **Streamlit:** Web application interface.
- **Pandas & NumPy:** Data wrangling and numerical operations.
- **Matplotlib/Seaborn:** Used for static EDA plots.
- **Scikit-learn (optional):** For scaling and clustering recipes by nutrition density (in extended version).

---

### 4.4 User Experience

The final Streamlit interface provides:
- Dropdown menus for cuisine and dietary preferences.
- Adjustable sliders for calorie targets.
- Automatic generation of a daily meal plan.
- Display of macro totals and health-conscious options.

Users can thus personalize meal planning interactively, with data-driven recommendations drawn directly from the EDA insights.

---

## 5. Conclusion

The exploratory analysis revealed valuable insights into how cuisines differ nutritionally and how meal compositions align with caloric goals.  
These insights informed the design of a personalized **Streamlit-based Meal Planner** capable of generating balanced meal combinations dynamically.

By integrating data-driven decision-making with an intuitive interface, the system empowers users to make healthier food choices suited to their preferences and goals.

Future enhancements could include:
- Incorporating user feedback loops for adaptive recommendations.
- Integrating APIs for real-time recipe updates.
- Adding ML-based clustering for automated diet pattern detection.

---

## References

1. McKinney, W. (2010). *Data Structures for Statistical Computing in Python*. Proceedings of the 9th Python in Science Conference.
2. Hunter, J. D. (2007). *Matplotlib: A 2D Graphics Environment*. Computing in Science & Engineering, 9(3), 90–95.
3. Streamlit Team. (2023). *Streamlit Documentation*. [https://docs.streamlit.io](https://docs.streamlit.io)
4. Pedregosa et al. (2011). *Scikit-learn: Machine Learning in Python*. Journal of Machine Learning Research, 12, 2825–2830.
5. Seaborn Developers. (2024). *Seaborn: Statistical Data Visualization*. [https://seaborn.pydata.org](https://seaborn.pydata.org)
